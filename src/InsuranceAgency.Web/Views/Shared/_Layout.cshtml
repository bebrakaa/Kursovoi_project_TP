@{
    var title = ViewData["Title"] as string ?? "–°—Ç—Ä–∞—Ö–æ–≤–æ–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ";
}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <title>@title - –°—Ç—Ä–∞—Ö–æ–≤–æ–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>
<body>
    @if (TempData["SuccessMessage"] != null)
    {
        var successMessage = TempData["SuccessMessage"]?.ToString();
        <div class="alert alert-success alert-dismissible fade show m-3 position-fixed top-0 start-50 translate-middle-x" style="z-index: 9999; margin-top: 20px !important; min-width: 300px; max-width: 90%;" role="alert" data-auto-dismiss="5000">
            @successMessage
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }
    @if (TempData["ErrorMessage"] != null)
    {
        var errorMessage = TempData["ErrorMessage"]?.ToString();
        <div class="alert alert-danger alert-dismissible fade show m-3 position-fixed top-0 start-50 translate-middle-x" style="z-index: 9999; margin-top: 20px !important; min-width: 300px; max-width: 90%;" role="alert" data-auto-dismiss="7000">
            @errorMessage
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
        <div class="container">
            <a class="navbar-brand fw-bold" href="@Url.Action("Index", "Home")">
                <span class="me-2">üõ°Ô∏è</span>–°—Ç—Ä–∞—Ö–æ–≤–æ–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="@Url.Action("Index", "Home")">–ì–ª–∞–≤–Ω–∞—è</a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    @if (User.Identity?.IsAuthenticated == true)
                    {
                        <li class="nav-item">
                            <a class="nav-link" href="@Url.Action("Index", "Dashboard")">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
                                @User.Identity.Name
                                @if (User.IsInRole("Administrator"))
                                {
                                    <span class="badge bg-danger ms-1">–ê–¥–º–∏–Ω</span>
                                }
                                else if (User.IsInRole("Agent"))
                                {
                                    <span class="badge bg-info ms-1">–ê–≥–µ–Ω—Ç</span>
                                }
                                else if (User.IsInRole("Client"))
                                {
                                    <span class="badge bg-success ms-1">–ö–ª–∏–µ–Ω—Ç</span>
                                }
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="@Url.Action("Index", "Dashboard")">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li>
                                    <form method="post" action="@Url.Action("Logout", "Account")" class="d-inline">
                                        <button type="submit" class="dropdown-item">–í—ã–π—Ç–∏</button>
                                    </form>
                                </li>
                            </ul>
                        </li>
                    }
                    else
                    {
                        <li class="nav-item">
                            <a class="nav-link" href="@Url.Action("Login", "Account")">–í—Ö–æ–¥</a>
                        </li>
                        <li class="nav-item">
                            <a class="btn btn-light text-primary ms-lg-3" href="@Url.Action("Register", "Account")">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
                        </li>
                    }
                </ul>
            </div>
        </div>
    </nav>

    <main class="container mb-5">
        @RenderBody()
    </main>

    <footer class="footer text-center">
        <div class="container">
            <p class="mb-1">&copy; @DateTime.UtcNow.Year –°—Ç—Ä–∞—Ö–æ–≤–æ–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            <small>–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç: ASP.NET Core, Entity Framework Core, JWT</small>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.alert[data-auto-dismiss]').forEach(alertEl => {
                const dismissDelay = parseInt(alertEl.getAttribute('data-auto-dismiss')) || 5000;
                const bsAlert = bootstrap.Alert.getOrCreateInstance(alertEl);
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
                const timeoutId = window.setTimeout(() => {
                    bsAlert.close();
                }, dismissDelay);
                
                // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Ä—É—á–Ω–æ–º –∑–∞–∫—Ä—ã—Ç–∏–∏
                alertEl.addEventListener('closed.bs.alert', () => {
                    window.clearTimeout(timeoutId);
                });
            });
        });
    </script>
    @RenderSection("Scripts", required: false)
</body>
</html>


